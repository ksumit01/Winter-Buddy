<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="index.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <title>Document</title>
  </head>
  <body>
    <!-- <h1>Winter Buddy</h1> -->

    <!-- ********************** NAV BAR *********************************************** -->
    <nav class="navbar">
      <div class="navbar-logo">
        <img
          src="./images/onlinelogomaker-022123-1530-6453-2000-transparent.png"
          alt=""
        />
      </div>

      <div class="navbar-content">
        <a href="#">About Us</a>
        <a href="#">Contact</a>
        <i class="fa-brands fa-facebook"></i>
        <i class="fa-brands fa-twitter"></i>
        <a href="./as1.html"><i class="fa-regular fa-user"></i></a>
        <i class="fa-solid fa-bag-shopping"></i>
      </div>
    </nav>

    <!-- ********************  HERO IMAGE **************************************** -->
    <div class="window-image">
      <img src="./secImage.png" alt="" />
      <div class="text-overlay">
        Discover the magic of winter with Winter Buddy.
      </div>
    </div>

    <!-- *******************SHOP CATEGORY ************************************* -->
    <div class="dropdown">
      <button class="dropbtn">Shop by Category</button>
      <div class="dropdown-content">
        <a href="#">Bottles</a>
        <a href="#">Jackets</a>
        <a href="#">Caps</a>
        <a href="#">Blankets</a>
      </div>
    </div>
    <!-- ***********************   SIDE BAR AND ITEM DATA CARD ************************ -->
    <div class="main_container">
      <div class="filter">
        <input type="checkbox" id="nofilter" value="Clear Filter" />
        <label for="nofilter">Clear Filter</label>
        <br />
        <input type="checkbox" value="bottles" id="bottles" />
        <label for="bottles">Bottle</label>
        <br />
        <input type="checkbox" name="" id="jackets" />
        <label for="jackets">Jackets</label>
        <br />
        <input type="checkbox" id="cap" value="cap" />
        <label for="cap">Cap</label>
        <br />
        <input type="checkbox" name="" id="heater" value="Heater" />
        <label for="heater">Heater</label>
        <br />
        <input type="checkbox" id="blankets" />
        <label for="blankets">Blankets</label>
      </div>

      <div id="container">
        <!-- Append the code here -->
      </div>
    </div>
  </body>
</html>
<script>
  async function fetchedData() {
    try {
      let res = await fetch(
        `https://63f4a21e55677ef68bc03f97.mockapi.io/products`
      );
      let data = await res.json();
      console.log(data);
      display(data);
    } catch (error) {
      console.log(error);
    }
  }

  fetchedData();

  let cartData = JSON.parse(localStorage.getItem("cart")) || [];

  let divContainer = document.getElementById("container");
  function display(data) {
    divContainer.innerHTML = null;
    data.forEach((ele) => {
      let card = document.createElement("div");
      card.classList.add("card-content");

      let image = document.createElement("img");
      image.setAttribute("src", ele.image);
      image.addEventListener("click", () => {
        console.log("hello");
        displayProductDetails(ele.id);
      });

      let title = document.createElement("h4");
      title.innerText = ele.title;

      let category = document.createElement("h2");
      category.innerText = ele.category;

      let description = document.createElement("p");
      description.innerText = ele.description;

      let type = document.createElement("h3");
      type.innerText = ele.type;

      let price = document.createElement("h4");
      price.innerText = ele.price;

      // let button = document.createElement("button");
      // button.innerText = "Add to cart";

      // button.addEventListener("click", function () {
      //   if (checkDuplicate(ele)) {
      //     alert("Product Already in Cart");
      //   } else {
      //     cartData.push({ ...ele, quantity: 1 });
      //     console.log(ele);
      //     localStorage.setItem("cart", JSON.stringify(cartData));
      //     alert("Product Added To Cart");
      //   }
      // });
      card.append(image, description, title, type, price);

      divContainer.append(card);
    });
  }

  function displayProductDetails(productId) {
    // Fetch the product details from the API
    fetch(`https://63f4a21e55677ef68bc03f97.mockapi.io/products/${productId}`)
      .then((response) => response.json())
      .then((product) => {
        // Redirect to the product details page with the product details as a query parameter
        window.open(
          `productDetails.html?product=${JSON.stringify(product)}`,
          "_blank"
        );
      })
      .catch((error) => console.log(error));
  }

  function checkDuplicate(product) {
    for (let i = 0; i < cartData.length; i++) {
      if (cartData[i].id == product.id) {
        return true;
      }
    }
    return false;
  }
</script>
